type Array a

foo : all (a, obsv :< DS). (Array a, obsv) -> Array a
foo (as, o) = let ?o = o
               in map[a, obsv] (as, \a => bar[a, obsv] (a, ?o))

bar : all (a, obsv :< DS). (a, obsv) -> a

map : all (a, obsv :< DS). {?o : obsv} -> (Array a, {?o : obsv} -> a -> a) -> Array a
map (as, f) = map_[a, obsv] (as, ?o, \(a, oo) => f a)

-- but we don't need to use map_ in .ac files, we can just instead make map_ the abstract function

map_ : all (a, obsv :< DS). (Array a, obsv, (a, obsv) -> a) -> Array a
